name: Debug FTP secrets presence (Environment PROD)

on:
  workflow_dispatch:

jobs:
  check-secrets:
    runs-on: ubuntu-latest
    environment: PROD
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Check FTP secrets presence
        run: |
          echo "Checking FTP secrets presence for environment PROD (will NOT show values)..."
          rc=0
          if [ -z "${{ secrets.FTP_HOST }}" ]; then
            echo "FTP_HOST: NOT SET"
            rc=1
          else
            echo "FTP_HOST: SET"
          fi
          if [ -z "${{ secrets.FTP_USER }}" ]; then
            echo "FTP_USER: NOT SET"
            rc=1
          else
            echo "FTP_USER: SET"
          fi
          if [ -z "${{ secrets.FTP_PASS }}" ]; then
            echo "FTP_PASS: NOT SET"
            rc=1
          else
            echo "FTP_PASS: SET"
          fi
          if [ $rc -ne 0 ]; then
            echo "::error::One or more required FTP secrets are missing in the PROD environment."
            exit $rc
          fi
          echo "All required FTP secrets in PROD are present."
